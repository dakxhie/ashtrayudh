<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Story - Astrayudh</title>
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Poppins:wght@400;500&display=swap" rel="stylesheet">
  <!-- Stylesheet -->
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <!-- Header / Navbar -->
  <header>
    <nav class="navbar">
      <a href="index.html" class="logo">Astrayudh</a>
      <ul class="nav-links">
        <li><a href="about.html">About</a></li>
        <li><a href="apps.html">Apps</a></li>
        <li><a href="blogs.html">Blogs</a></li>
        <li><a href="stories.html" class="active">Stories</a></li>
        <li><a href="contact.html">Contact</a></li>
      </ul>
    </nav>
  </header>

  <!-- Story Content Section -->
  <section class="story-content-section">
    <div class="container" id="story-container">
      <!-- Story and chapter content will be dynamically loaded here -->
    </div>
  </section>

  <!-- Footer -->
  <footer>
    <div class="container">
      <p>&copy; 2026 Astrayudh. All rights reserved.</p>
      <ul class="footer-links">
        <li><a href="privacy.html">Privacy Policy</a></li>
      </ul>
    </div>
  </footer>

  <!-- Story JS -->
  <script>
    const params = new URLSearchParams(window.location.search);
    const storyId = params.get('id');
    const chapterNumber = parseInt(params.get('chapter')) || 1;

    const storyContainer = document.getElementById('story-container');

    async function loadStory() {
      try {
        const response = await fetch('data/stories.json');
        if (!response.ok) throw new Error('Failed to fetch stories');

        const stories = await response.json();
        const story = stories.find(s => s.id === storyId);

        if (!story) {
          storyContainer.innerHTML = '<p>Story not found.</p>';
          return;
        }

        const chapter = story.chapters.find(c => c.chapterNumber === chapterNumber);
        if (!chapter) {
          storyContainer.innerHTML = '<p>Chapter not found.</p>';
          return;
        }

        // Build navigation
        const prevChapter = story.chapters.find(c => c.chapterNumber === chapterNumber - 1);
        const nextChapter = story.chapters.find(c => c.chapterNumber === chapterNumber + 1);

        storyContainer.innerHTML = `
          <h1>${story.title}</h1>
          <h2>${chapter.title}</h2>
          <div class="chapter-content">${chapter.content}</div>
          <div class="chapter-nav" style="margin-top:2rem; display:flex; gap:1rem; flex-wrap:wrap;">
            ${prevChapter ? `<a href="story-template.html?id=${story.id}&chapter=${prevChapter.chapterNumber}" class="btn-cta">&laquo; Previous</a>` : ''}
            <a href="stories.html" class="btn-cta">All Stories</a>
            ${nextChapter ? `<a href="story-template.html?id=${story.id}&chapter=${nextChapter.chapterNumber}" class="btn-cta">Next &raquo;</a>` : ''}
          </div>
        `;
      } catch (error) {
        console.error('Error loading story:', error);
        storyContainer.innerHTML = '<p>Error loading story content.</p>';
      }
    }

    document.addEventListener('DOMContentLoaded', loadStory);
  </script>
</body>
</html>
