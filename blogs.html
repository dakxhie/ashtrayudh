<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Blogs | Astrayudh</title>

  <link rel="stylesheet" href="style.css" />
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Poppins:wghtwght@300;400;500&display=swap" rel="stylesheet">
</head>

<body>

  <!-- NAVBAR -->
  <nav class="navbar">
    <div class="logo">Astrayudh</div>

    <div class="nav-links">
      <a href="index.html">Home</a>
      <a href="about.html">About</a>
      <a href="apps.html">Apps</a>
      <a href="blogs.html" class="active">Blogs</a>
      <a href="stories.html">Stories</a>
      <a href="contact.html">Contact</a>
    </div>

    <a href="contact.html" class="nav-btn">Let's Talk</a>
  </nav>

  <!-- BLOGS SECTION -->
  <section class="section blog-view">
    <div class="section-heading">
      <h2>Blogs</h2>
      <p>Thoughtful writing about calm design, storytelling, creativity, and meaningful technology.</p>
    </div>

    <div class="search-box">
      <input type="text" id="searchInput" placeholder="Search blogs..." onkeyup="searchBlogs()" />
    </div>

    <div class="cards" id="blogsContainer"></div>
  </section>

  <footer class="footer">
    <p>© 2026 Astrayudh. Crafted with calm design.</p>
    <div class="footer-links">
      <a href="privacy.html">Privacy Policy</a>
    </div>
  </footer>

  <script>
    let allBlogs = [];

    async function loadBlogs() {
      const container = document.getElementById("blogsContainer");

      // 1️⃣ Check LocalStorage first (Admin Panel)
      const localBlogs = localStorage.getItem("astrayudh_blogs");

      if (localBlogs) {
        allBlogs = JSON.parse(localBlogs);
      } else {
        // 2️⃣ If LocalStorage empty, load default blogs.json
        const response = await fetch("blogs.json");
        const data = await response.json();
        allBlogs = data.blogs;
      }

      renderBlogs(allBlogs);
    }

    function renderBlogs(blogs) {
      const container = document.getElementById("blogsContainer");

      if (blogs.length === 0) {
        container.innerHTML = `<p style="color:#b9b9c6;">No blogs found.</p>`;
        return;
      }

      container.innerHTML = blogs.map(blog => `
        <div class="card">
          <img src="${blog.image}" class="blog-img" alt="${blog.title}" />
          <h3>${blog.title}</h3>
          <p>${blog.excerpt}</p>
          <a href="blog-view.html?id=${blog.id}" class="btn secondary" style="margin-top:15px; display:inline-block;">
            Read More →
          </a>
        </div>
      `).join("");
    }

    function searchBlogs() {
      const searchValue = document.getElementById("searchInput").value.toLowerCase();

      const filtered = allBlogs.filter(blog =>
        blog.title.toLowerCase().includes(searchValue) ||
        blog.excerpt.toLowerCase().includes(searchValue)
      );

      renderBlogs(filtered);
    }

    loadBlogs();
  </script>

</body>
</html>
