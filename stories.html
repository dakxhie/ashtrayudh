<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Stories | Astrayudh</title>

  <link rel="stylesheet" href="style.css" />
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Poppins:wght@300;400;500&display=swap" rel="stylesheet">
</head>

<body>

  <!-- NAVBAR -->
  <nav class="navbar">
    <div class="logo">Astrayudh</div>

    <div class="nav-links">
      <a href="index.html">Home</a>
      <a href="about.html">About</a>
      <a href="apps.html">Apps</a>
      <a href="blogs.html">Blogs</a>
      <a href="stories.html" class="active">Stories</a>
      <a href="contact.html">Contact</a>
    </div>

    <a href="contact.html" class="nav-btn">Let's Talk</a>
  </nav>

  <!-- STORIES SECTION -->
  <section class="section story-view">
    <div class="section-heading">
      <h2>Stories</h2>
      <p>Serialized stories crafted with imagination, depth, and cinematic writing.</p>
    </div>

    <div class="search-box">
      <input type="text" id="searchInput" placeholder="Search stories..." onkeyup="searchStories()" />
    </div>

    <div class="cards" id="storiesContainer"></div>
  </section>

  <footer class="footer">
    <p>© 2026 Astrayudh. Crafted with calm design.</p>
    <div class="footer-links">
      <a href="privacy.html">Privacy Policy</a>
    </div>
  </footer>

  <script>
    let allStories = [];

    async function loadStories() {
      const container = document.getElementById("storiesContainer");

      // 1️⃣ Check LocalStorage first
      const localStories = localStorage.getItem("astrayudh_stories");

      if (localStories) {
        allStories = JSON.parse(localStories);
      } else {
        // 2️⃣ fallback to stories.json
        const response = await fetch("stories.json");
        const data = await response.json();
        allStories = data.stories;
      }

      renderStories(allStories);
    }

    function renderStories(stories) {
      const container = document.getElementById("storiesContainer");

      if (stories.length === 0) {
        container.innerHTML = `<p style="color:#b9b9c6;">No stories found.</p>`;
        return;
      }

      container.innerHTML = stories.map(story => `
        <div class="card">
          <h3>${story.title}</h3>
          <p>${story.description}</p>

          <p style="margin-top:12px; font-size:13px; color:#ff3d6e;">
            Chapters: ${story.chapters.length}
          </p>

          <a href="story-view.html?id=${story.id}" class="btn secondary" style="margin-top:15px; display:inline-block;">
            Read Story →
          </a>
        </div>
      `).join("");
    }

    function searchStories() {
      const searchValue = document.getElementById("searchInput").value.toLowerCase();

      const filtered = allStories.filter(story =>
        story.title.toLowerCase().includes(searchValue) ||
        story.description.toLowerCase().includes(searchValue)
      );

      renderStories(filtered);
    }

    loadStories();
  </script>

</body>
</html>
